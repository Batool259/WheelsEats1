{% extends "base.html" %}

{% block TITLE %}Startseite{% endblock %}

{% block CONTENT %}

<section class="my-3">
  <form class="row g-2 my-3" method="GET" action="{{ url_for('index') }}">
    <div class="col-md-10">
      <input
        class="form-control"
        name="q"
        type="text"
        placeholder="Restaurant oder Adresse"
        value="{{ q or '' }}">
    </div>

    <div class="col-md-2 d-grid">
      <button class="btn btn-primary" type="submit">Suchen</button>
    </div>

    <!-- Filter -->
    <div class="col-12 mt-2">
      <div class="d-flex flex-wrap gap-2">

        <input class="btn-check" type="checkbox" id="f_stufenlos" name="stufenloser_eingang" value="1"
               {% if filters and filters.stufenloser_eingang %}checked{% endif %}>
        <label class="btn btn-outline-primary btn-sm rounded-pill" for="f_stufenlos">Stufenlos</label>

        <input class="btn-check" type="checkbox" id="f_wc" name="barrierefreies_wc" value="1"
               {% if filters and filters.barrierefreies_wc %}checked{% endif %}>
        <label class="btn btn-outline-primary btn-sm rounded-pill" for="f_wc">Barrierefreies WC</label>

        <input class="btn-check" type="checkbox" id="f_rampe" name="rampe" value="1"
               {% if filters and filters.rampe %}checked{% endif %}>
        <label class="btn btn-outline-primary btn-sm rounded-pill" for="f_rampe">Rampe</label>

        <input class="btn-check" type="checkbox" id="f_tueren" name="breite_tueren" value="1"
               {% if filters and filters.breite_tueren %}checked{% endif %}>
        <label class="btn btn-outline-primary btn-sm rounded-pill" for="f_tueren">Breite TÃ¼ren</label>

        <input class="btn-check" type="checkbox" id="f_tische" name="unterfahrbare_tische" value="1"
               {% if filters and filters.unterfahrbare_tische %}checked{% endif %}>
        <label class="btn btn-outline-primary btn-sm rounded-pill" for="f_tische">Unterfahrbare Tische</label>

        <input class="btn-check" type="checkbox" id="f_park" name="behindertenparkplatz" value="1"
               {% if filters and filters.behindertenparkplatz %}checked{% endif %}>
        <label class="btn btn-outline-primary btn-sm rounded-pill" for="f_park">Behindertenparkplatz</label>

        <a class="btn btn-link btn-sm text-decoration-none" href="{{ url_for('index') }}">ZurÃ¼cksetzen</a>
      </div>
    </div>
  </form>
</section>

<section>
  <h2 class="mb-3">Barrierefreie Restaurants</h2>

  {% for r in restaurants %}
    {% set titelbild = r.fotos | selectattr("titelbild") | first %}

    <div class="card mb-3">
      <div class="card-body d-flex gap-3 align-items-start">

        <!-- Bild links -->
        <div style="width: 180px; flex: 0 0 180px;">
          {% if titelbild %}
            <img
              src="{{ url_for('static', filename=titelbild.dateipfad.replace('static/', '')) }}"
              class="img-fluid rounded-3"
              style="height: 110px; width: 180px;"
              alt="Bild von {{ r.name }}">
          {% else %}
            <img
              src="https://picsum.photos/360/220"
              class="img-fluid rounded-3"
              style="height: 110px; width: 180px;"
              alt="Platzhalterbild">
          {% endif %}
        </div>

        <!-- Infos Mitte -->
        <div class="flex-grow-1">
          <h5 class="card-title mb-1">{{ r.name }}</h5>
          <div class="text-muted mb-2">{{ r.adresse_zeile }}</div>

          <!-- Merkmale -->
          <div class="d-flex flex-wrap gap-2">
            {% if r.merkmale %}
              {% if r.merkmale.stufenloser_eingang %}
                <span class="badge badge-access badge-stepfree">â™¿ Stufenlos</span>
              {% endif %}
              {% if r.merkmale.barrierefreies_wc %}
                <span class="badge badge-access badge-wc">ğŸš» WC</span>
              {% endif %}
              {% if r.merkmale.rampe %}
                <span class="badge badge-access badge-ramp">â†—ï¸ Rampe</span>
              {% endif %}
              {% if r.merkmale.breite_tueren %}
                <span class="badge badge-access badge-door">&gt; 90 cm TÃ¼r</span>
              {% endif %}
              {% if r.merkmale.unterfahrbare_tische %}
                <span class="badge badge-access badge-table">ğŸª‘ Unterfahrbar</span>
              {% endif %}
              {% if r.merkmale.behindertenparkplatz %}
                <span class="badge badge-access badge-parking">ğŸ…¿ Parkplatz</span>
              {% endif %}
            {% endif %}
          </div>
        </div>

        <!-- Button rechts -->
        <div class="ms-auto">
          <a href="{{ url_for('detail', id=r.id) }}" class="btn btn-outline-primary">
            Details ansehen
          </a>
        </div>

      </div>
    </div>

  {% else %}
    <div class="text-muted">Keine Restaurants gefunden.</div>
  {% endfor %}
</section>

{% endblock %}
