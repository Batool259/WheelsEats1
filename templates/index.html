{% extends "base.html" %}

{% block TITLE %}Startseite{% endblock %}

{% block CONTENT %}

<section class="my-3">
  <form class="row g-2 my-3" method="get" action="{{ url_for('index') }}">
    <div class="col-md-10">
      <input
        class="form-control"
        type="text"
        name="q"
        value="{{ q or '' }}"
        placeholder="Restaurant oder Adresse">
    </div>
    <div class="col-md-2 d-grid">
      <button class="btn btn-primary" type="submit">Suchen</button>
    </div>
  </form>
</section>

<section>
  <h2 class="mb-3">Barrierefreie Restaurants</h2>

  {% for r in restaurants %}
    {% set titelbild = r.fotos | selectattr("titelbild") | first %}

    <div class="card mb-3">
      <div class="card-body d-flex gap-3 align-items-start">

        <!-- Bild links -->
        <div style="width: 180px; flex: 0 0 180px;">
          {% if titelbild %}
            <img
              src="{{ url_for('static', filename=titelbild.dateipfad.replace('static/', '')) }}"
              class="img-fluid rounded-3"
              style="height: 110px; width: 180px;"
              alt="Bild von {{ r.name }}">
          {% else %}
            <img
              src="https://picsum.photos/360/220"
              class="img-fluid rounded-3"
              style="height: 110px; width: 180px;"
              alt="Platzhalterbild">
          {% endif %}
        </div>

        <!-- Infos Mitte -->
        <div class="flex-grow-1">
          <h5 class="card-title mb-1">{{ r.name }}</h5>
          <div class="text-muted mb-2">{{ r.adresse_zeile }}</div>

          <!-- Merkmale -->
          <div class="d-flex flex-wrap gap-2">
            {% if r.merkmale %}
              {% if r.merkmale.stufenloser_eingang %}
                <span class="badge badge-access badge-stepfree">â™¿ Stufenlos</span>
              {% endif %}
              {% if r.merkmale.barrierefreies_wc %}
                <span class="badge badge-access badge-wc">ğŸš» WC</span>
              {% endif %}
              {% if r.merkmale.rampe %}
                <span class="badge badge-access badge-ramp">â†—ï¸ Rampe</span>
              {% endif %}
              {% if r.merkmale.breite_tueren %}
                <span class="badge badge-access badge-door">&gt; 90 cm TÃ¼r</span>
              {% endif %}
              {% if r.merkmale.unterfahrbare_tische %}
                <span class="badge badge-access badge-table">ğŸª‘ Unterfahrbar</span>
              {% endif %}
              {% if r.merkmale.behindertenparkplatz %}
                <span class="badge badge-access badge-parking">ğŸ…¿ Parkplatz</span>
              {% endif %}
            {% endif %}
          </div>
        </div>

        <!-- Button rechts -->
        <div class="ms-auto">
          <a href="{{ url_for('detail', id=r.id) }}" class="btn btn-outline-primary">
            Details ansehen
          </a>
        </div>

      </div>
    </div>

  {% else %}
    <div class="text-muted">Keine Restaurants gefunden.</div>
  {% endfor %}
</section>

{% endblock %}
